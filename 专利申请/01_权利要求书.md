# 权利要求书

## 一种基于多尺度Transformer的电池SOH和SOC联合预测方法及系统

---

### 独立权利要求

**权利要求1**（方法）

一种基于多尺度Transformer的电池健康状态(SOH)和充电状态(SOC)联合预测方法，其特征在于，包括以下步骤：

1. **数据采集步骤**：采集电池运行过程中的时间序列数据，所述时间序列数据包括充电电流、最大单体电压、最小单体电压、最大单体温度、最小单体温度和累计里程；

2. **多尺度特征提取步骤**：对所述时间序列数据进行多尺度特征提取，具体包括：
   - 使用第一卷积层提取短期特征，所述第一卷积层的卷积核大小为3，用于捕获单个充放电循环内的瞬时变化特征；
   - 使用第二卷积层提取中期特征，所述第二卷积层的卷积核大小为7，用于捕获5-10个充放电循环的趋势特征；
   - 使用第三卷积层提取长期特征，所述第三卷积层的卷积核大小为15，用于捕获电池整体老化退化模式；
   - 分别通过三个Transformer编码器对所述短期特征、中期特征和长期特征进行时序建模；

3. **跨尺度自适应注意力融合步骤**：通过跨尺度注意力机制对多尺度特征进行自适应加权融合，具体包括：
   - 对短期特征、中期特征和长期特征分别进行全局平均池化；
   - 将池化后的特征拼接后输入注意力权重网络，计算三个尺度的自适应权重；
   - 根据所述自适应权重对三个尺度的特征进行加权融合，得到融合特征；

4. **联合预测步骤**：将所述融合特征分别输入SOC预测头和SOH预测头，同时输出电池的充电状态和健康状态。

---

**权利要求2**（系统）

一种基于多尺度Transformer的电池SOH和SOC联合预测系统，其特征在于，包括：

1. **数据采集模块**：用于采集电池运行过程中的时间序列数据；

2. **多尺度特征提取模块**：包括短期特征提取单元、中期特征提取单元和长期特征提取单元，分别用于提取不同时间尺度的电池退化特征；

3. **跨尺度注意力融合模块**：用于根据电池当前状态自适应地调整不同时间尺度特征的重要性权重，并进行加权融合；

4. **双任务预测模块**：包括SOC预测头和SOH预测头，用于同时输出电池的充电状态和健康状态。

---

### 从属权利要求

**权利要求3**

根据权利要求1所述的方法，其特征在于，所述多尺度特征提取步骤中，三个Transformer编码器均采用轻量化设计，具体参数为：
- 模型维度(d_model)为64；
- 注意力头数(nhead)为4；
- 前馈网络维度(dim_feedforward)为128；
使得整个模型的参数量小于200K，适合边缘端BMS设备部署。

**权利要求4**

根据权利要求1所述的方法，其特征在于，所述跨尺度自适应注意力融合步骤中，注意力权重网络包括：
- 第一全连接层，输入维度为d_model×3，输出维度为128；
- ReLU激活函数；
- 第二全连接层，输入维度为128，输出维度为3；
- Softmax归一化层，输出三个尺度的权重和为1。

**权利要求5**

根据权利要求1所述的方法，其特征在于，所述方法还包括可解释性输出步骤：输出三个时间尺度的注意力权重，用于分析模型在不同电池状态下对不同时间尺度特征的关注程度。

**权利要求6**

根据权利要求1所述的方法，其特征在于，所述联合预测步骤采用多任务学习策略，SOC预测头和SOH预测头共享所述融合特征，通过联合训练提升模型的泛化能力。

**权利要求7**

根据权利要求1所述的方法，其特征在于，所述方法还包括模型压缩步骤：
- 对训练好的模型进行动态量化，将权重从FP32量化为INT8，模型大小减少约75%；
- 对模型进行剪枝，移除20%-30%的不重要参数；
- 将压缩后的模型导出为ONNX格式，便于跨平台部署。

**权利要求8**

根据权利要求2所述的系统，其特征在于，所述多尺度特征提取模块中：
- 短期特征提取单元使用kernel_size=3的一维卷积层；
- 中期特征提取单元使用kernel_size=7的一维卷积层；
- 长期特征提取单元使用kernel_size=15的一维卷积层；
三个卷积层并行处理输入时间序列，分别提取不同时间窗口的特征。

**权利要求9**

根据权利要求2所述的系统，其特征在于，所述系统还包括模型压缩模块和边缘部署模块，用于将训练好的模型压缩并部署到资源受限的BMS设备。

**权利要求10**

根据权利要求2所述的系统，其特征在于，所述双任务预测模块中：
- SOC预测头包括两个全连接层，维度分别为64→32→1；
- SOH预测头包括两个全连接层，维度分别为64→32→1；
- 两个预测头结构相同但参数独立，通过联合训练优化。

---

## 附加说明

### 技术效果

相比现有技术，本发明具有以下有益效果：

1. **预测精度高**：通过多尺度特征提取，充分捕获电池在不同时间维度的退化特征，SOC和SOH预测精度显著优于单尺度方法；

2. **模型轻量化**：模型参数量小于200K（约800KB），量化后小于200KB，适合部署在资源受限的边缘端BMS设备；

3. **自适应性强**：跨尺度注意力机制能够根据电池当前状态自动调整不同时间尺度的重要性，对不同老化阶段的电池均有良好的预测效果；

4. **可解释性好**：输出各时间尺度的注意力权重，便于理解模型决策过程，提升工程实用性；

5. **部署便捷**：支持模型量化、剪枝和ONNX导出，可方便地部署到CPU、GPU、嵌入式设备等多种平台。

---

## 权利要求保护范围说明

- 独立权利要求1保护的是方法本身
- 独立权利要求2保护的是实现该方法的系统
- 从属权利要求3-10对方法和系统的具体实现细节进行保护

建议的保护策略：
1. 核心保护：多尺度特征提取 + 跨尺度自适应注意力融合
2. 辅助保护：轻量化设计、模型压缩、边缘部署
3. 应用保护：电池SOH/SOC预测的具体应用场景
